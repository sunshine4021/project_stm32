/*******************************************************

* 文件名：my_uart.c

* 作者：  luyangguang

* 描述： 串口驱动初始化

* 修改人：〈卢阳光〉

* 修改时间：2021-04-24

* 修改内容：创建
*******************************************************/

/*******************  头文件包含 ***********************/
/******************************************************/

#include "my_usart.h"
#include "my_master_task.h"
#include "my_com.h"

/******************************************************/
/*******************  全局变量定义 *********************/
/******************************************************/

/******************************************************/
/*******************  数据类型定义 *********************/
/******************************************************/

/******************************************************/
/*******************  外部变量引用 *********************/
/******************************************************/

/******************************************************/
/*******************  本地函数声明 *********************/
/******************************************************/


/******************************************************/
/*******************  外部函数引用 *********************/
/******************************************************/







/******************************************************************************
 * Function  -  my_drv_uart_send_mastter
 * Purpose   -  串口中断收到数据要发送给master
 * Params 
 *   @uint8_t *data
 *   @uint16_t data_len
 * Return
 *   @  
 * Limitation -   
 * ----------------------------------------
 * Modification history
 * luyangguang create  @2022-04-10
 ******************************************************************************/
void my_drv_uart_send_mastter(uint8_t *data,uint16_t data_len)
{
	my_task_message_struct message = {0};
	uint8_t *send_data = NULL;
	
	send_data = (uint8_t *) pvPortMalloc(data_len + 1);
	
	memcpy(send_data,data,data_len);
					
	message.mes_id = MY_MASTER_UART_DATA_RECV;
	message.data_len = data_len;
	message.pvdata = send_data;
	message.param_1 = 1;

	xQueueSendToBackFromISR(my_master_task_get_queuue_handle(),&message,0);

	//发送失败要释放资源的	
}


















